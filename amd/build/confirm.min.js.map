{"version":3,"file":"confirm.min.js","sources":["../src/confirm.js"],"sourcesContent":["/*\n * @package    local_order\n * @copyright  2021 Andres, DQ.\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nconst modules = [\"jquery\", \"core/modal_factory\", \"core/modal_events\"];\ndefine(modules, function ($, ModalFactory, ModalEvents) {\n  return {\n    init: function () {\n      /**\n       * Adds an event listener for the 'beforeunload' event, stopping immediate propagation.\n       * @param {Event} event - The event object.\n       */\n      window.addEventListener(\"beforeunload\", (evt) =>\n        evt.stopImmediatePropagation()\n      );\n\n      // Select the form with the name 'updatestatus' using jQuery\n      const form = $(\"form[name='updatestatus']\");\n      // Find the cancel and submit buttons within the form\n      const cancelButton = form.find(\"input#id_cancel\");\n      const submitButton = form.find(\"input#id_submitbutton\");\n      const deleteButton = form.find(\"a.action-delete\");\n\n      // Add a click event listener to delete action links\n      deleteButton.on(\"click\", function (e) {\n        e.preventDefault();\n        var href = $(this).attr(\"href\");\n\n        // Create a confirmation modal for deletion\n        ModalFactory.create(\n          {\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: \"Delete\",\n            body: \"Do you really want to delete this record?\",\n          },\n          $(\".create-modal\")\n        ).done(function (modal) {\n          // Handle the save event of the modal\n          modal.getRoot().on(ModalEvents.save, function () {\n            // Redirect to the provided href on save\n            location.href = href;\n          });\n\n          // Show the modal\n          modal.show();\n        });\n      });\n\n      // Add a click event listener to the cancel button\n      cancelButton.on(\"click\", function (evt) {\n        evt.preventDefault(); // Prevent the default form submission behavior\n\n        // Get the 'action-cancel' attribute from the form and navigate to that URL\n        const formAction = form.attr(\"action-cancel\");\n        location.href = formAction;\n      });\n\n      // Add a click event listener to the submit button\n      submitButton.on(\"click\", function (evt) {\n        evt.preventDefault(); // Prevent the default form submission behavior\n\n        // Get the 'action' attribute from the form\n        const formAction = form.attr(\"action\");\n\n        // Create a confirmation modal for updating order status\n        ModalFactory.create(\n          {\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: \"Update order status\",\n            body: \"Do you really want to update this order? It may result in unregistering students from their courses.\",\n          },\n          $(\".create-modal\")\n        ).done(function (modal) {\n          // Handle the save event of the modal\n          modal.getRoot().on(ModalEvents.save, function () {\n            form.prop(\"action\", formAction).submit(); // Set the form action and submit the form\n          });\n\n          // Show the modal\n          modal.show();\n        });\n      });\n    },\n  };\n});\n"],"names":["define","$","ModalFactory","ModalEvents","init","window","addEventListener","evt","stopImmediatePropagation","form","cancelButton","find","submitButton","on","e","preventDefault","href","this","attr","create","type","types","SAVE_CANCEL","title","body","done","modal","getRoot","save","location","show","formAction","prop","submit"],"mappings":";;;;;AAOAA,6BADgB,CAAC,SAAU,qBAAsB,sBACjC,SAAUC,EAAGC,aAAcC,mBAClC,CACLC,KAAM,WAKJC,OAAOC,iBAAiB,gBAAiBC,KACvCA,IAAIC,mCAIAC,KAAOR,EAAE,6BAETS,aAAeD,KAAKE,KAAK,mBACzBC,aAAeH,KAAKE,KAAK,yBACVF,KAAKE,KAAK,mBAGlBE,GAAG,SAAS,SAAUC,GACjCA,EAAEC,qBACEC,KAAOf,EAAEgB,MAAMC,KAAK,QAGxBhB,aAAaiB,OACX,CACEC,KAAMlB,aAAamB,MAAMC,YACzBC,MAAO,SACPC,KAAM,6CAERvB,EAAE,kBACFwB,MAAK,SAAUC,OAEfA,MAAMC,UAAUd,GAAGV,YAAYyB,MAAM,WAEnCC,SAASb,KAAOA,QAIlBU,MAAMI,aAKVpB,aAAaG,GAAG,SAAS,SAAUN,KACjCA,IAAIQ,uBAGEgB,WAAatB,KAAKS,KAAK,iBAC7BW,SAASb,KAAOe,cAIlBnB,aAAaC,GAAG,SAAS,SAAUN,KACjCA,IAAIQ,uBAGEgB,WAAatB,KAAKS,KAAK,UAG7BhB,aAAaiB,OACX,CACEC,KAAMlB,aAAamB,MAAMC,YACzBC,MAAO,sBACPC,KAAM,wGAERvB,EAAE,kBACFwB,MAAK,SAAUC,OAEfA,MAAMC,UAAUd,GAAGV,YAAYyB,MAAM,WACnCnB,KAAKuB,KAAK,SAAUD,YAAYE,YAIlCP,MAAMI"}